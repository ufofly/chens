<!DOCTYPE HTML>
<html lang="zh-CN">


<head>
    <meta charset="utf-8">
    <meta name="keywords" content="输入输出重定向, 日拱一卒">
    <meta name="description" content="重定向的概念
https://www.gnu.org/software/bash/manual/html_node/Redirections.html

在执行命令之前，可以使用Shell解释的特殊符号重定向其输入和输出。重定向允许复制、打">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <!-- Global site tag (gtag.js) - Google Analytics -->


    <title>输入输出重定向 | 日拱一卒</title>
    <link rel="icon" type="image/png" href="/favicon.png">
    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/all.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <link rel="stylesheet" type="text/css" href="/css/dark.css">
    <script src="/libs/jquery/jquery-3.6.0.min.js"></script>
<meta name="generator" content="Hexo 6.1.0"></head>




<body>
<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <img src="/medias/logo.png" class="logo-img" alt="LOGO">
                    
                    <span class="logo-span">日拱一卒</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a>
<ul class="right nav-menu">
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/" class="waves-effect waves-light">
      
      <i class="fas fa-home" style="zoom: 0.6;"></i>
      
      <span>首页</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/archives" class="waves-effect waves-light">
      
      <i class="fas fa-archive" style="zoom: 0.6;"></i>
      
      <span>归档</span>
    </a>
    
  </li>
  
  <li class="hide-on-med-and-down nav-item">
    
    <a href="/about" class="waves-effect waves-light">
      
      <i class="fas fa-user-circle" style="zoom: 0.6;"></i>
      
      <span>关于</span>
    </a>
    
  </li>
  
  <li>
    <a href="#searchModal" class="modal-trigger waves-effect waves-light">
      <i id="searchIcon" class="fas fa-search" title="搜索" style="zoom: 0.85;"></i>
    </a>
  </li>
</ul>


<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">日拱一卒</div>
        <div class="logo-desc">
            
            network security
            
        </div>
    </div>

    <ul class="menu-list mobile-menu-list">
        
        <li class="m-nav-item">
	  
		<a href="/" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-home"></i>
			
			首页
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/archives" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-archive"></i>
			
			归档
		</a>
          
        </li>
        
        <li class="m-nav-item">
	  
		<a href="/about" class="waves-effect waves-light">
			
			    <i class="fa-fw fas fa-user-circle"></i>
			
			关于
		</a>
          
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/ufofly" class="waves-effect waves-light" target="_blank">
                <i class="fab fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>


        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/ufofly" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>


<main id="main_wrap">
    



<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/13.jpg')">
    <div class="container" style="right: 0px;left: 0px;">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <h1 class="description center-align post-title">输入输出重定向</h1>
                </div>
            </div>
        </div>
    </div>
</div>




<main class="post-container content">

    
    <link rel="stylesheet" href="/libs/tocbot/tocbot.css">
<style>
    #articleContent h1::before,
    #articleContent h2::before,
    #articleContent h3::before,
    #articleContent h4::before,
    #articleContent h5::before,
    #articleContent h6::before {
        display: block;
        content: " ";
        height: 100px;
        margin-top: -100px;
        visibility: hidden;
    }

    #articleContent :focus {
        outline: none;
    }

    .toc-fixed {
        position: fixed;
        top: 64px;
    }

    .toc-widget {
        width: 345px;
        padding-left: 20px;
    }

    .toc-widget .toc-title {
        padding: 35px 0 15px 17px;
        font-size: 1.5rem;
        font-weight: bold;
        line-height: 1.5rem;
    }

    .toc-widget ol {
        padding: 0;
        list-style: none;
    }

    #toc-content {
        padding-bottom: 30px;
        overflow: auto;
    }

    #toc-content ol {
        padding-left: 10px;
    }

    #toc-content ol li {
        padding-left: 10px;
    }

    #toc-content .toc-link:hover {
        color: #42b983;
        font-weight: 700;
        text-decoration: underline;
    }

    #toc-content .toc-link::before {
        background-color: transparent;
        max-height: 25px;

        position: absolute;
        right: 23.5vw;
        display: block;
    }

    #toc-content .is-active-link {
        color: #42b983;
    }

    #floating-toc-btn {
        position: fixed;
        right: 15px;
        bottom: 137px;
        padding-top: 15px;
        margin-bottom: 0;
        z-index: 998;
    }

    #floating-toc-btn .btn-floating {
        width: 48px;
        height: 48px;
    }

    #floating-toc-btn .btn-floating i {
        line-height: 48px;
        font-size: 1.4rem;
    }
</style>
<div class="row">
    <div id="main-content" class="col s12 m12 l9">
        <!-- 文章内容详情 -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                            <a href="/tags/linux/">
                                <span class="chip bg-color">linux</span>
                            </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                </div>
            </div>

            <div class="post-info">
                
                <div class="post-date info-break-policy">
                    <i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp;
                    2023-10-23
                </div>
                

                

                

                

                
            </div>
        </div>
        <hr class="clearfix">

        
        <!-- 是否加载使用自带的 prismjs. -->
        <link rel="stylesheet" href="/libs/prism/prism.css">
        

        

        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="重定向的概念"><a href="#重定向的概念" class="headerlink" title="重定向的概念"></a>重定向的概念</h2><blockquote>
<p><a target="_blank" rel="noopener" href="https://www.gnu.org/software/bash/manual/html_node/Redirections.html">https://www.gnu.org/software/bash/manual/html_node/Redirections.html</a></p>
</blockquote>
<p>在执行命令之前，可以使用Shell解释的特殊符号重定向其输入和输出。重定向允许复制、打开、关闭命令文件句柄，并更改命令读取和写入的文件。还可以使用重定向修改当前Shell执行环境中的文件句柄。以下重定向运算符可能出现在简单命令内任何位置或跟随一个命令：它们按从左到右的顺序处理。</p>
<p>当下面文件名用于重定向时，bash 会进行特殊处理：</p>
<ul>
<li>&#x2F;dev&#x2F;fd&#x2F;fd：如果 <em>fd</em> 是一个已经打开的文件描述符整数值，则 &#x2F;dev&#x2F;fd&#x2F;fd 文件会复制到文件描述符 <em>fd</em></li>
<li>&#x2F;dev&#x2F;stdin：复制到文件描述符 0，也可以写为 &#x2F;dev&#x2F;fd&#x2F;0。文件描述符 0 一般对应标准输入</li>
<li>&#x2F;dev&#x2F;stdout：复制到文件描述符 1，也可以写为 &#x2F;dev&#x2F;fd&#x2F;1。文件描述符 1 一般对应标准输入</li>
<li>&#x2F;dev&#x2F;stderr：复制到文件描述符 2，也可以写为 &#x2F;dev&#x2F;fd&#x2F;2。文件描述符 2 一般对应标准错误输出</li>
</ul>
<p>基于上面说明，可以使用 &#x2F;dev&#x2F;fd&#x2F;5 来复制到文件描述符 5。<br>文件描述符 5 必须对应一个打开的文件，否则会报错。<br>也就是要有某个已打开文件的文件描述符是 5，&#x2F;dev&#x2F;fd&#x2F;5 才能复制到文件描述符 5。</p>
<p>当使用大于 9 的文件描述符时，要特别小心。<br>shell 自身可能也使用了某个大于 9 的文件描述符，会导致冲突。</p>
<h2 id="重定向的先后顺序"><a href="#重定向的先后顺序" class="headerlink" title="重定向的先后顺序"></a>重定向的先后顺序</h2><p>在使用重定向，要注意重定向的先后顺序，这是很重要的点，当指定了多个重定向操作时，按照重定向出现的顺序，从左到右处理。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ls</span> <span class="token operator">></span> dirlist <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>对 <code>ls &gt; dirlist 2&gt;&amp;1</code> 命令来说，第一个 <code>&gt;</code> 表示重定向 <code>ls</code> 命令的标准输出到 <em>dirlist</em> 文件。第二个 <code>2&gt;&amp;1</code> 表示复制标准错误输出到标准输出。由于标准输出已经被重定向到 <em>dirlist</em> 文件，所以 <em>dirlist</em> 文件会包含 <code>ls</code> 命令的标准输出和标准错误输出。</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ls</span> <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">></span> dirlist<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>


<p>而 <code>ls 2&gt;&amp;1 &gt; dirlist</code> 命令只重定向标准输出到 <em>dirlist</em> 文件，标准错误输出只会打印到终端。具体说明如下：</p>
<ul>
<li>第一个 <code>2&gt;&amp;1</code> 表示复制标准错误输出的文件描述符 2 到标准输出的文件描述符 1。</li>
</ul>
<p>实际上是把标准错误输出写入到标准输出对应的文件。<br>此时标准输出还没有重定向，会关联到终端，所以标准错误输出会写入到终端。</p>
<ul>
<li>第二个 <code>&gt;</code> 表示把标准输出重定向到 <em>dirlist</em> 文件，会把文件描述符 1 指向 <em>dirlist</em> 文件。</li>
</ul>
<p>这不会影响文件描述符 2，标准错误输出的文件描述符 2 还是指向终端。<br>所以， 标准错误输出没有重定向到 <em>dirlist</em> 文件。</p>
<p>具体举例测试如下：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">ls</span> not_exist <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">></span> dirlist
ls: cannot access not_exist: No such <span class="token function">file</span> or directory
$ <span class="token function">ls</span> not_exist <span class="token operator">></span> dirlist <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span>
$ <span class="token function">cat</span> dirlist
ls: cannot access not_exist: No such <span class="token function">file</span> or directory<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在当前目录下，没有 <em>not_exist</em> 文件。那么 <code>ls not_exist</code> 会报错，提示找不到该文件。</p>
<p>如前面说明，<code>ls not_exist 2&gt;&amp;1 &gt; dirlist</code> 命令不能把标准错误输出重定向到 <em>dirlist</em> 文件，所以报错信息直接打印在终端上。</p>
<p><code>ls not_exist &gt; dirlist 2&gt;&amp;1</code> 命令可以把标准错误输出重定向到 <em>dirlist</em> 文件，终端上没有看到报错信息。<br>用 <code>cat dirlist</code> 命令输出 <em>dirlist</em> 文件内容，可以看到报错信息写入到了该文件。</p>
<h2 id="使用-exec-命令对当前-shell-进行重定向"><a href="#使用-exec-命令对当前-shell-进行重定向" class="headerlink" title="使用 exec 命令对当前 shell 进行重定向"></a>使用 exec 命令对当前 shell 进行重定向</h2><p>在 bash 中执行命令，会启动子 shell 来执行。此时的重定向只影响执行命令的子 shell，不影响当前 shell。<br>如果要对当前 shell 进行重定向，可以使用 bash 的 <code>exec</code> 内置命令。</p>
<p>查看 man bash 里面对 <code>exec</code> 命令的说明如下：</p>
<blockquote>
<p>Note that the exec builtin command can make redirections take effect in the current shell.</p>
<p><strong>exec [-cl] [-a name] [command [arguments]]</strong><br>If command is specified, it replaces the shell. No new process is created. The arguments become the arguments to command.<br>If command is not specified, any redirections take effect in the current shell, and the return status is 0.<br>If there is a redirection error, the return status is 1.</p>
</blockquote>
<p>即，当 <code>exec</code> 没有指定要执行的命令时，可以直接在当前 shell 进行重定向。<br>例如，把当前的 shell 标准输入重定向到文件，不再从键盘读取输入。</p>
<p>下面具体举例说明如何使用 <code>exec</code> 命令来进行重定向。</p>
<ul>
<li>重定向当前 shell 的标准输出到文件（如果终端自身不支持保存log功能，可以使用这个方法来把命令输出都保存到文件）：</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token builtin class-name">exec</span> <span class="token operator"><span class="token file-descriptor important">1</span>></span>output.txt
$ <span class="token function">ls</span>
$ <span class="token function">cat</span> output.txt
cat: output.txt: input <span class="token function">file</span> is output <span class="token function">file</span>
$ <span class="token builtin class-name">exec</span> <span class="token operator"><span class="token file-descriptor important">1</span>></span>/dev/stdin
$ <span class="token function">cat</span> output.txt
testfile<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在这个例子中，<code>exec 1&gt;output.txt</code> 命令把当前 shell 的标准输出重定向到 <em>output.txt</em> 文件。<br>那么标准输出不再关联到终端。<br>执行 <code>ls</code> 命令，终端上看不到任何输出，<code>ls</code> 命令的输出结果被写入到 <em>output.txt</em> 文件。</p>
<p>此时，无法在当前 shell 上输出 <em>output.txt</em> 文件的内容。<br>执行 <code>cat output.txt</code> 命令，提示输入文件是输出文件，会形成循环，不会在终端上输出 <em>output.txt</em> 文件内容。</p>
<p>此时要查看 <em>output.txt</em> 文件的内容，可以在另外的终端上查看，或者取消重定向当前 shell 的标准输出到 <em>output.txt</em> 文件。<br><code>exec 1&gt;/dev/stdin</code> 命令把当前 shell 的标准输出重定向到 <em>&#x2F;dev&#x2F;stdin</em> 文件，会关联到终端。<br>执行 <code>cat output.txt</code> 命令，就能输出 <em>output.txt</em> 文件内容到终端上。</p>
<p><strong>注意</strong>：这里有一个比较古怪的地方，需要执行 <code>exec 1&gt;/dev/stdin</code> 命令把对应标准输入的 <em>&#x2F;dev&#x2F;stdin</em> 文件关联到文件描述符 1，才能重新输出到终端上。<br>执行 <code>exec 1&gt;/dev/stdout</code> 命令并不能重定向标准输出到终端上。</p>
<p>在重定向中使用 <em>&#x2F;dev&#x2F;stdout</em> 文件，会复制到文件描述符 1。<br>而文件描述符 1 之前已经重定向到 <em>output.txt</em> 文件。<br>所以 <code>exec 1&gt;/dev/stdout</code> 命令还是让文件描述符 1 关联到 <em>output</em>.txt 文件，并不是关联到终端。</p>
<p>在重定向中使用 <em>&#x2F;dev&#x2F;stdin</em> 文件，会复制到文件描述符 0。<br>而文件描述符 0 没有重定向，关联到终端。<br>所以 <code>exec 1&gt;/dev/stdin</code> 命令会让文件描述符 1 关联到终端。</p>
<ul>
<li>重定向当前 shell 的标准输入到文件：</li>
</ul>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">cat</span> input.txt
<span class="token function">date</span>
<span class="token function">sleep</span> <span class="token number">2</span>
$ <span class="token builtin class-name">exec</span> <span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span>input.txt
$ <span class="token function">date</span>
<span class="token number">2019</span>年 <span class="token number">11</span>月 <span class="token number">28</span>日 星期四 <span class="token number">13</span>:14:11 CST<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以看到，用 <code>cat input.txt</code> 命令打印 <em>input.txt</em> 文件内容。<br>这个文件里面有两行，分别是 <code>date</code> 命令和 <code>sleep 2</code> 命令。<br>这个 <code>sleep</code> 命令用于延迟终端退出，否则执行后面命令，终端会很快关闭，终端窗口一闪而过。</p>
<p>执行 <code>exec 0&lt;input.txt</code> 命令，会把当前 shell 的标准输入重定向到 <em>input.txt</em> 文件。<br>则 shell 会开始逐行读取该文件内容，并把每行内容当作命令来执行。<br>所以后面看到执行了 <code>date</code> 命令，这个命令并不是通过键盘手动输入。</p>
<p>自动执行 <code>date</code> 命令后，会再执行 <code>sleep 2</code> 命令，等秒 2 秒，接着就会退出当前 shell。</p>
<p>这是因为 bash shell 遇到 EOF 就会退出。<br>例如打开一个 shell，输入 CTRL-D，就会退出 shell。<br>重定向标准输入到 <em>input.txt</em> 文件后，当前 shell 读取完该文件内容，就会遇到 EOF，所以会退出 shell。</p>
<h2 id="重定向输入"><a href="#重定向输入" class="headerlink" title="重定向输入"></a>重定向输入</h2><p>查看重定向输入（Redirecting Input）的说明如下：</p>
<blockquote>
<p>Redirection of input causes the file whose name results from the expansion of word to be opened for reading on file descriptor n, or the standard input (file descriptor 0) if n is not specified.<br>The general format for redirecting input is:</p>
</blockquote>
<pre class="line-numbers language-angelscript" data-language="angelscript"><code class="language-angelscript">[n]&lt;word<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>即，<code>[n]&lt;word</code> 用读模式打开 <em>word</em> 文件，并关联到文件描述符 <em>n</em> 上。<br>如果没有提供文件描述符 <em>n</em>，默认关联到文件描述符 0 上，也就是标准输入。<br>重定向输入后，从文件描述符 <em>n</em> 读取内容，会读取到所关联的 <em>word</em> 文件内容。</p>
<p>例如，重定向标准输入后，<em>word</em> 文件关联到文件描述符 0。<br>被执行的命令读取标准输入，也就是读取文件描述符 0，从而读取到 <em>word</em> 文件的内容，不需要从键盘进行输入。</p>
<p>重定向输入的例子说明如下：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">cat</span> <span class="token operator">&lt;</span> input.txt
<span class="token function">date</span>
<span class="token function">sleep</span> <span class="token number">2</span>
$ <span class="token builtin class-name">exec</span> <span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span> input.txt
$ <span class="token function">cat</span> /dev/fd/3
<span class="token function">date</span>
<span class="token function">sleep</span> <span class="token number">2</span>
$ <span class="token builtin class-name">read</span> -u <span class="token number">3</span> line
$ <span class="token builtin class-name">echo</span> <span class="token variable">$line</span>
<span class="token function">date</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>在 <code>cat &lt; input.txt</code> 命令中，执行 <code>cat</code> 命令且没有提供文件名参数，那么 <code>cat</code> 命令默认读取标准输入。<br><code>&lt; input.txt</code> 表示把 <em>input.txt</em> 文件关联到文件描述符 0，也就是关联到被执行命令的标准输入。<br><code>cat</code> 命令读取标准输入时，读取的就是 <em>input.txt</em> 文件的内容。<br>这只影响被执行命令的标准输入，不影响当前 shell 的标准输入。</p>
<p>执行 <code>exec 3&lt; input.txt</code> 命令把 <em>input.txt</em> 文件关联到文件描述符 3 的输入。<br>之后，读取文件描述符 3，读取的就是 <em>input.txt</em> 文件的内容。<br>用 <code>cat /dev/fd/3</code> 命令读取文件描述符 3，获取到的内容确实和 <em>input.txt</em> 文件内容一致。</p>
<p><code>read -u 3 line</code> 命令使用 <code>-u</code> 选项指定从文件描述符 3 读取一行，保存到 <em>line</em> 变量。<br>打印 <em>line</em> 变量值，读取到的内容就是 <em>input.txt</em> 文件的第一行。</p>
<h2 id="重定向输出"><a href="#重定向输出" class="headerlink" title="重定向输出"></a>重定向输出</h2><p>查看重定向输出（Redirecting Output）的说明如下：</p>
<blockquote>
<p>Redirection of output causes the file whose name results from the expansion of word to be opened for writing on file descriptor n, or the standard output (file descriptor 1) if n is not specified.<br>If the file does not exist it is created; if it does exist it is truncated to zero size.<br>The general format for redirecting output is:</p>
</blockquote>
<pre class="line-numbers language-angelscript" data-language="angelscript"><code class="language-angelscript">[n]&gt;word<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>即，<code>[n]&gt;word</code> 用写模式打开 <em>word</em> 文件，并关联到文件描述符 <em>n</em> 上。<br>如果没有提供文件描述符 <em>n</em>，默认关联到文件描述符 1 上，也就是标准输出。<br>重定向输出后，往文件描述符 <em>n</em> 写入内容，会写入到所关联的 <em>word</em> 文件。</p>
<p>如果 <em>word</em> 文件不存在，会创建该文件。<br>如果 <em>word</em> 文件已经存在，则把它的文件大小截断成 0，会丢弃原有的内容。</p>
<p>重定向标准输出是重定向最常见的用法之一。<br>重定向输出的例子说明如下：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token builtin class-name">echo</span> <span class="token string">"redirection output"</span> <span class="token operator">></span> output.txt
$ <span class="token function">cat</span> output.txt
redirection output
$ <span class="token builtin class-name">exec</span> <span class="token operator"><span class="token file-descriptor important">5</span>></span> output.txt
$ <span class="token function">cat</span> input.txt <span class="token operator">></span> /dev/fd/5
$ <span class="token function">cat</span> output.txt
<span class="token function">date</span>
<span class="token function">sleep</span> <span class="token number">2</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>echo &quot;redirection output&quot; &gt; output.txt</code> 命令把 <code>echo</code> 命令的标准输出重定向到 <em>output.txt</em> 文件。<br>那么 <code>echo</code> 命令的输出结果就是写入到该文件。</p>
<p>用 <code>cat output.txt</code> 命令查看 <em>output.txt</em> 文件内容，可以看到重定向标准输出写入的字符串。</p>
<p><code>exec 5&gt; output.txt</code> 命令把 <em>output.txt</em> 文件关联到文件描述符 5 的输出。<br>之后，往文件描述符 5 写入内容，就是写入到 <em>output.txt</em> 文件。</p>
<p><code>cat input.txt &gt; /dev/fd/5</code> 命令把标准输出重定向到文件描述符 5。<br>那么所输出的 <em>input.txt</em> 文件内容会被写入到文件描述符 5。</p>
<p>用 <code>cat output.txt</code> 命令输出 <em>output.txt</em> 文件内容，已经不再是 “redirection output” 字符串。<br>而是跟 <em>input.txt</em> 文件的内容一致。</p>
<h2 id="追加重定向输出"><a href="#追加重定向输出" class="headerlink" title="追加重定向输出"></a>追加重定向输出</h2><p>查看追加重定向输出（Appending Redirected Output）的说明如下：</p>
<blockquote>
<p>Redirection of output in this fashion causes the file whose name results from the expansion of word to be opened for appending on file descriptor n, or the standard output (file descriptor 1) if n is not specified.<br>If the file does not exist it is created.<br>The general format for appending output is:</p>
</blockquote>
<pre class="line-numbers language-angelscript" data-language="angelscript"><code class="language-angelscript">[n]&gt;&gt;word<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>即，<code>[n]&gt;&gt;word</code> 命令用追加写入模式打开 <em>word</em> 文件，并关联到文件描述符 <em>n</em> 上。<br>如果没有提供文件描述符 <em>n</em>，默认关联到文件描述符 1 上，也就是标准输出。<br>重定向输出后，往文件描述符 <em>n</em> 写入内容，会追加写入到所关联的 <em>word</em> 文件。</p>
<p>如果 <em>word</em> 文件不存在，会创建该文件。<br>如果 <em>word</em> 文件已经存在，会把内容追加写入到文件末尾，不会丢弃原有的内容。</p>
<p>追加重定向输出的例子说明如下：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">cat</span> output.txt
<span class="token function">date</span>
<span class="token function">sleep</span> <span class="token number">2</span>
$ <span class="token builtin class-name">echo</span> <span class="token string">"append"</span> <span class="token operator">>></span> output.txt
$ <span class="token function">cat</span> output.txt
<span class="token function">date</span>
<span class="token function">sleep</span> <span class="token number">2</span>
append<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>先用 <code>cat output.txt</code> 命令查看 <em>output.txt</em> 文件的内容。<br>然后使用 <code>echo &quot;append&quot; &gt;&gt; output.txt</code> 命令追加重定向标准输出到 <em>output.txt</em> 文件。</p>
<p>再次查看 <em>output.txt</em> 文件，原有的内容还在，并在文件末尾追加了写入的 “append” 字符串。</p>
<p>当重定向的输出文件不存在时，<code>&gt;</code> 和 <code>&gt;&gt;</code> 都会新建该文件。<br>当输出文件已经存在时，<code>&gt;</code> 会清空该文件的内容，然后再写入新的内容（如果有的话）。<br>而 <code>&gt;&gt;</code> 会将新写入的内容追加到该文件的末尾，文件原来的内容还会保留。</p>
<h2 id="同时重定向标准输出和标准错误输出"><a href="#同时重定向标准输出和标准错误输出" class="headerlink" title="同时重定向标准输出和标准错误输出"></a>同时重定向标准输出和标准错误输出</h2><p>查看同时重定向标准输出和标准错误输出（Redirecting Standard Output and Standard Error）的说明如下：</p>
<blockquote>
<p>This construct allows both the standard output (file descriptor 1) and the standard error output (file descriptor 2) to be redirected to the file whose name is the expansion of word.<br>There are two formats for redirecting standard output and standard error:</p>
</blockquote>
<pre class="line-numbers language-1c" data-language="1c"><code class="language-1c">&amp;&gt;word<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>and</p>
</blockquote>
<pre class="line-numbers language-1c" data-language="1c"><code class="language-1c">&gt;&amp;word<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>Of the two forms, the first is preferred. This is semantically equivalent to</p>
</blockquote>
<pre class="line-numbers language-1c" data-language="1c"><code class="language-1c">&gt;word 2&gt;&amp;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>When using the second form, word may not expand to a number or -.<br>If it does, other redirection operators apply (see Duplicating File Descriptors below) for compatibility reasons.</p>
</blockquote>
<p>即，可以使用 <code>&amp;&gt;word</code>、或者 <code>&gt;&amp;word</code> 来同时重定向标准输出和标准错误输出。</p>
<p>建议采用 <code>&amp;&gt;word</code> 这个写法。<br>在语义上，这个写法等同于 <code>&gt;word 2&gt;&amp;1</code>。<br><code>2&gt;&amp;1</code> 这个写法表示复制文件描述符。后面会具体说明。</p>
<p>如果使用 <code>&gt;&amp;word</code> 这种形式来同时重定向标准输出和标准错误输出，那么 <em>word</em> 文件名不能是数字，也不能是连字符 -。<br>因为这种写法是复制文件描述符，而复制文件描述符时，数字和 - 具有特殊含义，不会当成文件名处理。</p>
<p>当重定向标准输出到文件后，如果命令执行出错，错误信息会打印到标准错误输出，会在终端上看到这些打印。<br>如果确实需要把标准错误输出也重定向到文件，就可以使用 <code>&amp;&gt;word</code> 来同时重定向标准输出和标准错误输出。这里不再举例。</p>
<h2 id="同时追加重定向标准输出和标准错误输出"><a href="#同时追加重定向标准输出和标准错误输出" class="headerlink" title="同时追加重定向标准输出和标准错误输出"></a>同时追加重定向标准输出和标准错误输出</h2><p>查看同时追加重定向标准输出和标准错误输出（Appending Standard Output and Standard Error）的说明如下：</p>
<blockquote>
<p>This construct allows both the standard output (file descriptor 1) and the standard error output (file descriptor 2) to the appended to the file whose name is the expansion of word.<br>The format for appending standard output and standard error is:</p>
</blockquote>
<pre class="line-numbers language-1c" data-language="1c"><code class="language-1c">&amp;&gt;&gt;word<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>This is semantically equivalent to</p>
</blockquote>
<pre class="line-numbers language-1c" data-language="1c"><code class="language-1c">&gt;&gt;word 2&gt;&amp;1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>即，可以使用 <code>&amp;&gt;&gt;word</code> 来同时追加重定向标准输出和标准错误输出。<br>这个命令在语义上，等同于 <code>&gt;&gt;word 2&gt;&amp;1</code>。</p>
<h2 id="Here-Documents"><a href="#Here-Documents" class="headerlink" title="Here Documents"></a>Here Documents</h2><p>前面说明的重定向输入需要提供文件名，会有一个单独的文件。<br>编写 shell 脚本时，如果需要进行重定向输入，这个脚本就会依赖一个外部的文件，增加耦合。</p>
<p>我们可以使用 <em>Here Documents</em> 机制来重定向标准输入为指定的字符串，不需要提供外部文件名。<br>查看 <em>Here Documents</em> 的说明如下：</p>
<blockquote>
<p>This type of redirection instructs the shell to read input from the current source until a line containing only delimiter (with no trailing blanks) is seen.<br>All of the lines read up to that point are then used as the standard input for a command. The format of here-documents is:</p>
</blockquote>
<pre class="line-numbers language-applescript" data-language="applescript"><code class="language-applescript"><span class="token operator">&lt;</span><span class="token operator">&lt;</span>[<span class="token operator">-</span>]word
    here<span class="token operator">-</span>document
delimiter<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<blockquote>
<p>No parameter expansion, command substitution, arithmetic expansion, or pathname expansion is performed on word.<br>If any characters in word are quoted, the delimiter is the result of quote removal on word, and the lines in the here-document are not expanded.<br>If word is unquoted, all lines of the here-document are subjected to parameter expansion, command substitution, and arithmetic expansion.<br>In the latter case, the character sequence &lt;newline&gt; is ignored, and must be used to quote the characters , $, and &#96;.<br>If the redirection operator is &lt;&lt;-, then all leading tab characters are stripped from input lines and the line containing delimiter.<br>This allows here-documents within shell scripts to be indented in a natural fashion.</p>
</blockquote>
<p>即，可以使用 here-documents 格式来重定向标准输入：</p>
<ul>
<li><em>word</em> 指定一个字符串。如果字符串带有空格，需要用引号括起来。</li>
<li><em>here-document</em> 内容会被重定向到标准输入。</li>
</ul>
<p>当某一行内容完全等于 <em>word</em> 指定的字符串时（行首、行末的空白字符也会用来比较），则停止重定向。</p>
<ul>
<li><em>delimiter</em> 对应 <em>word</em> 指定的字符串，会去掉 <em>word</em> 中的引号。</li>
</ul>
<p>所给的 <em>delimiter</em> 不会被重定向到标准输入。</p>
<p>这里的 <em>word</em> 字符串不会进行参数扩展、命令替换、算法括号、或路径名扩展，意味着不能用 <code>$var</code> 的形式来获取 <em>var</em> 变量值。<br>如果 <em>word</em> 写为 <code>$var</code>，对应的 <em>delimiter</em> 字符串就是 <em>$var</em>。</p>
<p>当 <em>word</em> 字符串的任意字符被引号括起来时，对应的 <em>delimiter</em> 字符串不会包含这些引号。<br>而且中间的 <em>here-document</em> 字符串不会进行扩展。<br>例如，不能在 <em>here-document</em> 中用 <code>$var</code> 的形式来获取 <em>var</em> 变量值。</p>
<p>当 <em>word</em> 字符串中没有引号时，中间的 <em>here-document</em> 字符串可以进行参数扩展、命令替换、算法括号，不进行路径名扩展。</p>
<p>对 <code>&lt;&lt;word</code> 这个写法来说，中间 <em>here-document</em> 字符串的任意字符都会被保留，包括行首、行末的空白字符。<br>而写为 <code>&lt;&lt;-word</code> 时，中间 <em>here-document</em> 字符串行首的 tab 字符会被去掉，行首的空格还是会保留。</p>
<p>下面举例说明各种情况的 here-documents 格式写法。</p>
<ul>
<li>在 here-document 中不进行扩展</li>
</ul>
<p>假设有一个 <code>testhere.sh</code> 脚本文件，内容如下：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token function">cat</span> -A <span class="token operator">&lt;&lt;</span><span class="token string">"The end"</span>
This is a here-document.
    The end
The end  
<span class="token variable"><span class="token variable">$((</span><span class="token number">3</span><span class="token operator">+</span><span class="token number">7</span><span class="token variable">))</span></span>
The end<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>该脚本执行 <code>cat -A</code> 命令，<code>-A</code> 选项会在输出的行末打印一个 <code>$</code> 字符，以便看到行末结尾。<br>这里用 <code>&lt;&lt;&quot;The end&quot;</code> 指定 here-documents 类型的重定向输入。<br><code>cat</code> 命令会从 here-documents 获取标准输入，直到读取 “The end” 字符串为止。</p>
<p>在 <code>&lt;&lt;</code> 后面的 “The end” 字符串带有空格，要用引号括起来。<br>如果不加引号，会执行报错。</p>
<p>在 <code>$((3+7))</code> 上一行的 “The end “ 字符串后面有两个空格。<br>在测试的时候要注意在行末加上空格。</p>
<p>执行 <code>testhere.sh</code> 脚本，打印结果如下：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ ./testhere.sh
This is a here-document.$
    The end$
The end  $
<span class="token variable"><span class="token variable">$((</span><span class="token number">3</span><span class="token operator">+</span><span class="token number">7</span><span class="token variable">))</span></span>$<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以看到，here-documents 的第二行 “ The end”，在行首带有空格。<br>这一行不完全匹配 “The end”，没有停止重定向。</p>
<p>第三行内容是 “The end “，在行末有两个空格，也是不完全匹配 “The end”，没有停止重定向。</p>
<p>第四行内容是 “$((3+7))”，这是一个算术扩展表达式。<br>但是这里的 <em>word</em> 参数值是 “The end”，带有引号，不会进行算术扩展，会原样输出 “$((3+7))” 字符串。</p>
<p>第五行内容是 “The end”，完全匹配 “The end”，停止重定向。</p>
<p>停止重定向后，<code>cat -A</code> 命令会打印从标准输入读取到的所有内容，并在行末打印 <code>$</code> 字符。</p>
<p>最后一行的 “The end” 字符串没有被重定向输入到 <code>cat</code> 命令。</p>
<ul>
<li>在 here-document 中进行扩展</li>
</ul>
<p>前面提到，如果 <code>&lt;&lt;word</code> 的 <em>word</em> 没有包含引号，则 <em>here-document</em> 中的内容可以进行参数扩展、命令替换、算术扩展，不进行路径名扩展。<br>修改 <code>testhere.sh</code> 脚本为下面的内容，测试这种情况：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token assign-left variable">number</span><span class="token operator">=</span><span class="token string">"1234567"</span>
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token string">end
number = <span class="token variable">$number</span>
<span class="token variable"><span class="token variable">$(</span><span class="token function">date</span><span class="token variable">)</span></span>
<span class="token variable"><span class="token variable">$((</span><span class="token number">3</span><span class="token operator">+</span><span class="token number">7</span><span class="token variable">))</span></span>
test*
end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里的停止重定向字符串是 <em>end</em>，没有加引号。<br>里面的 <em>here-document</em> 用 <code>$number</code> 获取 <em>number</em> 变量值。<br>用 <code>$(date)</code> 执行 <code>date</code> 命令并获取改命令的输出，也就是命令替换。<br>用 <code>$((3+7))</code> 进行算术扩展。</p>
<p>执行修改后的 <code>testhere.sh</code> 脚本，打印结果如下：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ ./testhere.sh
number <span class="token operator">=</span> <span class="token number">1234567</span>
<span class="token number">2019</span>年 <span class="token number">11</span>月 <span class="token number">28</span>日 星期四 <span class="token number">16</span>:38:36 CST
<span class="token number">10</span>
test*<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以看到，打印结果里面确实获取到了 <em>number</em> 变量值，打印了 <code>date</code> 命令的执行结果，并进行算术扩展。<br>但是 <code>test*</code> 没有进行路径名扩展，没有扩展成当前目录下以 “test” 开头的文件名。</p>
<ul>
<li>word 参数不进行扩展</li>
</ul>
<p>在 <code>&lt;&lt;word</code> 中，<em>word</em> 本身不进行参数扩展、命令替换、算法括号、或路径名扩展，所给的字符串会保持不变。<br>无法通过获取变量值的方式来指定停止重定向的字符串。</p>
<p>修改 <code>testhere.sh</code> 脚本内容为下面的内容：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span>

<span class="token assign-left variable">number</span><span class="token operator">=</span><span class="token string">"12345"</span>
<span class="token function">cat</span> <span class="token operator">&lt;&lt;</span><span class="token variable">$name</span>
What is the name?
<span class="token number">12345</span>
<span class="token variable">$name</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里指定停止重定向的字符串为 <code>$name</code>，<em>name</em> 变量值是 “12345”。<br>在 here-document 中提供了 “12345” 这一行，之后是 <code>$name</code> 这一行。</p>
<p>执行修改后的 <code>testhere.sh</code> 脚本，打印结果如下：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ ./testhere.sh
What is the name?
<span class="token number">12345</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>可以看到，输出结果里面包含了 “12345” 这一行，说明这一行没有停止重定向。<br><code>&lt;&lt;$name</code> 并不会获取 <em>name</em> 变量值来作为停止重定向的字符串，而是保持停止重定向的字符串为 <code>$name</code> 不变。</p>
<h2 id="Here-Strings"><a href="#Here-Strings" class="headerlink" title="Here Strings"></a>Here Strings</h2><p>前面说明的 here-documents 可以重定向多行到标准输入。如果只需要重定向一行，也可以使用 <em>Here Strings</em>。<br>查看 <em>Here Strings</em> 的说明如下：</p>
<blockquote>
<p>A variant of here documents, the format is:</p>
</blockquote>
<pre class="line-numbers language-applescript" data-language="applescript"><code class="language-applescript"><span class="token operator">&lt;</span><span class="token operator">&lt;</span><span class="token operator">&lt;</span>word<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>The word undergoes brace expansion, tilde expansion, parameter and variable expansion, command substitution, arithmetic expansion, and quote removal. Pathname expansion and word splitting are not performed.<br>The result is supplied as a single string to the command on its standard input.</p>
</blockquote>
<p>即，here-strings 会把所给的 <em>word</em> 重定向到命令的标准输入，<em>word</em> 可以进行扩展。</p>
<p>跟 here-documents 不同，here-strings 的 <em>word</em> 无论是否加引号，都会进行参数扩展、命令替换、算术扩展、大括号扩展、波浪号扩展，并移除引号。<br>但是不进行路径名扩展和单词拆分。</p>
<p>如果 <em>word</em> 带有空格，需要用引号括起来，否则可能会报错。<br>对 <code>&lt;&lt;&lt;here strings</code> 这种写法来说，其实是 <code>&lt;&lt;&lt;</code>、<code>here</code>、<code>strings</code> 三个参数。<br>如果被执行命令不能处理这三个参数，就会报错。<br>如果想要把 <code>here strings</code> 当成一个参数，需要用引号括起来，例如 <code>&lt;&lt;&lt;&quot;here strings&quot;</code>。</p>
<p>具体举例说明如下：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token assign-left variable">number</span><span class="token operator">=</span><span class="token number">1</span> <span class="token number">2</span> <span class="token number">3</span> <span class="token number">4</span> <span class="token number">5</span>
$ <span class="token function">grep</span> <span class="token number">2</span> <span class="token operator">&lt;&lt;&lt;</span><span class="token variable">$number</span>
<span class="token number">12345</span>
$ <span class="token function">grep</span> t <span class="token operator">&lt;&lt;&lt;</span>test string
grep: string: No such <span class="token function">file</span> or directory<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里的 <code>&lt;&lt;&lt;$number</code> 会获取 <em>number</em> 变量值来重定向到标准输入。<br><code>grep</code> 命令没有提供文件名参数时，默认读取标准输入。<br>经过重定向，读取到 <em>number</em> 变量值。</p>
<p>在 <code>grep t &lt;&lt;&lt;test string</code> 命令中，<code>test string</code> 中带有空格，没有用引号括起来。<br>那么 <code>&lt;&lt;&lt;test</code> 是 here-strings 类型的重定向输入，后面的 <em>string</em> 是另外的参数，会被 <code>grep</code> 命令当成文件名处理。<br>当前目录下没有该文件，执行报错。</p>
<p>在 <code>&lt;word</code>、<code>&lt;&lt;word</code>、<code>&lt;&lt;&lt;word</code> 这三种形式中，<em>word</em> 的类型有如下差异：</p>
<ul>
<li>在 <code>&lt;word</code> 中，<em>word</em> 是文件名，读取文件内容作为重定向输入的来源。即使用引号把 <em>word</em> 括起来，也还是当成文件名，不会当成字符串处理。</li>
<li>在 <code>&lt;&lt;word</code> 中，<em>word</em> 是字符串，不会被当成文件名处理，也不会进行扩展。</li>
<li>在 <code>&lt;&lt;&lt;word</code> 中，<em>word</em> 是字符串，不会被当成文件名处理，会进行扩展。具体扩展类型如前面说明。</li>
</ul>
<h2 id="复制文件描述符"><a href="#复制文件描述符" class="headerlink" title="复制文件描述符"></a>复制文件描述符</h2><p>查看复制文件描述符（Duplicating File Descriptors）的说明如下：</p>
<blockquote>
<p>The redirection operator</p>
</blockquote>
<pre class="line-numbers language-1c" data-language="1c"><code class="language-1c">[n]&lt;&amp;word<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>is used to duplicate input file descriptors. If word expands to one or more digits, the file descriptor denoted by n is made to be a copy of that file descriptor.</p>
<p>If the digits in word do not specify a file descriptor open for input, a redirection error occurs.</p>
<p>If word evaluates to -, file descriptor n is closed. If n is not specified, the standard input (file descriptor 0) is used.</p>
<p>The operator</p>
</blockquote>
<pre class="line-numbers language-1c" data-language="1c"><code class="language-1c">[n]&gt;&amp;word<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>is used similarly to duplicate output file descriptors. If n is not specified, the standard output (file descriptor 1) is used.<br>If the digits in word do not specify a file descriptor open for output, a redirection error occurs.<br>If word evaluates to -, file descriptor n is closed.<br>As a special case, if n is omitted, and word does not expand to one or more digits or -, the standard output and standard error are redirected as described previously.</p>
</blockquote>
<p>即，<code>[n]&lt;&amp;word</code> 把文件描述符 <em>n</em> 复制到文件描述符 <em>word</em>。<br>如果文件描述符 <em>word</em> 没有对应以写模式打开的文件，则重定向报错。<br>如果 <em>word</em> 的值是连字符 -，则会关闭文件描述符 <em>n</em>。<br>如果没有提供文件描述符 <em>n</em>，默认会使用文件描述符 0，也就是标准输入。</p>
<p>类似的，<code>[n]&gt;&amp;word</code> 把文件描述符 <em>n</em> 复制到文件描述符 <em>word</em>。<br>如果文件描述符 <em>word</em> 没有对应以读模式打开的文件，则重定向报错。<br>如果 <em>word</em> 的值是连字符 -，则会关闭文件描述符 <em>n</em>。<br>如果没有提供文件描述符 <em>n</em>，默认会使用文件描述符 1，也就是标准输出。</p>
<p>有一种特别情况是，当 <code>[n]&gt;&amp;word</code> 中的 <em>word</em> 扩展结果不是数字、也不是连字符 - 时，<em>word</em> 会被当成文件名处理。<br>也就是前面说明的“同时重定向标准输出和标准错误输出”这种场景。</p>
<p>这个复制文件描述符的行为类似于 Linux 的 dup() 系统调用函数。<br>这两个文件描述符会指向同一个文件表（file table），共享文件偏移指针。<br>所以它们写入的内容是交错开的，不会发生覆盖的现象。</p>
<p>在编译大型项目代码时，就经常用到 <code>2&gt;&amp;1</code> 这个写法。<br>例如可以使用下面命令全编译 Android 源码：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">make</span> -j16 <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span> <span class="token operator">|</span> <span class="token function">tee</span> build_android.log<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这个命令使用 <code>2&gt;&amp;1</code>，把标准错误输入复制到标准输出。<br>那么写入到标准错误输出的内容也会写入到标准输出，然后通过管道 <code>|</code> 把标准输出重定向给下一个命令。</p>
<p>当使用管道 <code>|</code> 来重定向前一个命令的输出到后一个命令的输入时，只会重定向标准输出，不会重定向标准错误输出。<br>如果想重定向标准错误输出，可以写为 <code>2&gt;&amp;1 |</code>。<br>这种写法会先将标准错误输出重定向到标准输出上，然后再一起输出到管道上。</p>
<p>实际上，更简单的写法是 <code>|&amp;</code>。<br>查看 man bash 的 <em>Pipelines</em> 小节提到了这一点，具体描述如下：</p>
<blockquote>
<p>If |&amp; is used, the standard error of command is connected to command2’s standard input through the pipe; it is shorthand for 2&gt;&amp;1 |.<br>This implicit redirection of the standard error is performed after any redirections specified by the command.</p>
</blockquote>
<h2 id="移动文件描述符"><a href="#移动文件描述符" class="headerlink" title="移动文件描述符"></a>移动文件描述符</h2><p>查看移动文件描述符（Moving File Descriptors）的说明如下：</p>
<blockquote>
<p>The redirection operator</p>
</blockquote>
<pre class="line-numbers language-1c" data-language="1c"><code class="language-1c">[n]&lt;&amp;digit-<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>moves the file descriptor digit to file descriptor n, or the standard input (file descriptor 0) if n is not specified. digit is closed after being duplicated to n.</p>
<p>Similarly, the redirection operator</p>
</blockquote>
<pre class="line-numbers language-1c" data-language="1c"><code class="language-1c">[n]&gt;&amp;digit-<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>moves the file descriptor digit to file descriptor n, or the standard output (file descriptor 1) if n is not specified.</p>
</blockquote>
<p>即，<code>[n]&lt;&amp;digit-</code> 把文件描述符 <em>digit</em> 复制到文件描述符 <em>n</em>，然后关闭文件描述符 <em>digit</em>。<br>后面的连字符 - 必须提供。<br>如果没有提供文件描述符 <em>n</em>，默认使用文件描述符 0，也就是标准输入。</p>
<p>类似的，<code>[n]&gt;&amp;digit-</code> 把文件描述符 <em>digit</em> 复制到文件描述符 <em>n</em>，然后关闭文件描述符 <em>digit</em>。<br>后面的连字符 - 必须提供。<br>如果没有提供文件描述符 <em>n</em>，默认使用文件描述符 1，也就是标准输出。</p>
<p>这个移动文件描述符的行为和 Linux 的 dup2() 系统调用函数有所区别。<br>dup2() 函数将老的文件描述符（后面称之为 <em>oldfd</em>）复制到新的文件描述符（后面称之为 <em>newfd</em>）。<br>如果 <em>newfd</em> 之前是打开的，会先关闭 <em>newfd</em>，但是这个函数不会关闭 <em>oldfd</em>。<br>而 <code>[n]&lt;&amp;digit-</code>、<code>[n]&gt;&amp;digit-</code> 会在复制文件描述符之后，关闭 <em>digit</em> 对应的文件描述符。</p>
<p><strong>注意</strong>：在 <code>[n]&lt;&amp;digit-</code>、<code>[n]&gt;&amp;digit-</code> 中，如果省略了 <em>digit</em>，就变成 <code>[n]&lt;&amp;-</code>、<code>[n]&gt;&amp;-</code>。<br>这是前面“复制文件描述符”的写法，会关闭文件描述符 <em>n</em>。</p>
<h2 id="以读写模式打开文件描述符"><a href="#以读写模式打开文件描述符" class="headerlink" title="以读写模式打开文件描述符"></a>以读写模式打开文件描述符</h2><p>前面说明的文件描述符都对应到一个已经打开的文件。例如，<code>n&gt;word</code> 是把 <em>word</em> 文件关联到已经打开的文件描述符 <em>n</em> 上。<br>而下面介绍的重定向方式会打开一个新的文件描述符。</p>
<p>查看以读写模式打开文件描述符（Opening File Descriptors for Reading and Writing）的说明如下：</p>
<blockquote>
<p>The redirection operator</p>
</blockquote>
<pre class="line-numbers language-angelscript" data-language="angelscript"><code class="language-angelscript">[n]&lt;&gt;word<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<blockquote>
<p>causes the file whose name is the expansion of word to be opened for both reading and writing on file descriptor n, or on file descriptor 0 if n is not specified.<br>If the file does not exist, it is created.</p>
</blockquote>
<p>即，<code>[n]&lt;&gt;word</code> 会以读写模式打开 <em>word</em> 文件，且打开后的文件描述符为 <em>n</em>。<br>如果没有文件描述符 <em>n</em>，默认会打开到文件描述符 0 上。</p>
<p>如果 <em>word</em> 文件不存在，会创建该文件。<br>如果 <em>word</em> 文件已经存在，且往文件描述符 <em>n</em> 写入内容，则会把清空 <em>word</em> 文件原有的内容，然后写入新的内容。</p>
<p>具体举例说明如下：</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">cat</span> output.txt
<span class="token function">date</span>
<span class="token function">sleep</span> <span class="token number">2</span>
$ <span class="token builtin class-name">echo</span> <span class="token string">"new string"</span> <span class="token operator"><span class="token file-descriptor important">3</span>&lt;></span> output.txt <span class="token operator">></span> /dev/fd/3
$ <span class="token function">cat</span> output.txt
new string<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>这里先用 <code>cat output.txt</code> 命令查看 <em>output.txt</em> 文件内容，说明该文件存在，且自身内容不为空。</p>
<p>在 <code>echo &quot;new string&quot; 3&lt;&gt; output.txt &gt; /dev/fd/3</code> 命令里面，<code>3&lt;&gt; output.txt</code> 以读写模式打开 <em>output.txt</em> 文件，并关联到文件描述符 3 上。<br>后面的 <code>&gt; /dev/fd/3</code> 表示把 <code>echo</code> 的输出结果重定向到 &#x2F;dev&#x2F;fd&#x2F;3 文件，也就是重定向到文件描述符 3，那么会写入到 <em>output.txt</em> 文件。</p>
<p>之后再次用 <code>cat output.txt</code> 命令查看 <em>output.txt</em> 文件内容。可见文件原有内容已经丢失，变成 <code>echo</code> 命令输出的字符串。</p>

                
            </div>
            <hr/>

            

    <div class="reprint" id="reprint-statement">
        
            <div class="reprint__author">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-user">
                        文章作者:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="/about" rel="external nofollow noreferrer">chens</a>
                </span>
            </div>
            <div class="reprint__type">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-link">
                        文章链接:
                    </i>
                </span>
                <span class="reprint-info">
                    <a href="http://cshx.fun/2023/10/23/shu-ru-shu-chu-chong-ding-xiang/">http://cshx.fun/2023/10/23/shu-ru-shu-chu-chong-ding-xiang/</a>
                </span>
            </div>
            <div class="reprint__notice">
                <span class="reprint-meta" style="font-weight: bold;">
                    <i class="fas fa-copyright">
                        版权声明:
                    </i>
                </span>
                <span class="reprint-info">
                    本博客所有文章除特別声明外，均采用
                    <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a>
                    许可协议。转载请注明来源
                    <a href="/about" target="_blank">chens</a>
                    !
                </span>
            </div>
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>



            <div class="tag_share" style="display: block;">
                <div class="post-meta__tag-list" style="display: inline-block;">
                    
                        <div class="article-tag">
                            
                                <a href="/tags/linux/">
                                    <span class="chip bg-color">linux</span>
                                </a>
                            
                        </div>
                    
                </div>
                <div class="post_share" style="zoom: 80%; width: fit-content; display: inline-block; float: right; margin: -0.15rem 0;">
                    <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">
<div id="article-share">

    
    <div class="social-share" data-sites="twitter,facebook,google,qq,qzone,wechat,weibo,douban,linkedin" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div>
    <script src="/libs/share/js/social-share.min.js"></script>
    

    

</div>

                </div>
            </div>
            
        </div>
    </div>

    

    

    

    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fas fa-chevron-left"></i>&nbsp;上一篇</div>
            <div class="card">
                <a href="/2023/12/01/php-xiang-guan/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/11.jpg" class="responsive-img" alt="php相关">
                        
                        <span class="card-title">php相关</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="far fa-clock fa-fw icon-date"></i>2023-12-01
                        </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            chens
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/php/">
                        <span class="chip bg-color">php</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                下一篇&nbsp;<i class="fas fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2023/04/24/fan-dan-shell/">
                    <div class="card-image">
                        
                        
                        <img src="/medias/featureimages/20.jpg" class="responsive-img" alt="反弹shell">
                        
                        <span class="card-title">反弹shell</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="far fa-clock fa-fw icon-date"></i>2023-04-24
                            </span>
                        <span class="publish-author">
                            
                            <i class="fas fa-user fa-fw"></i>
                            chens
                            
                        </span>
                    </div>
                </div>
                
            </div>
        </div>
        
    </div>
</article>

</div>



<!-- 代码块功能依赖 -->
<script type="text/javascript" src="/libs/codeBlock/codeBlockFuction.js"></script>

<!-- 代码语言 -->

<script type="text/javascript" src="/libs/codeBlock/codeLang.js"></script>


<!-- 代码块复制 -->

<script type="text/javascript" src="/libs/codeBlock/codeCopy.js"></script>


<!-- 代码块收缩 -->

<script type="text/javascript" src="/libs/codeBlock/codeShrink.js"></script>


    </div>
    <div id="toc-aside" class="expanded col l3 hide-on-med-and-down">
        <div class="toc-widget card">
            <div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div>
            <div id="toc-content"></div>
        </div>
    </div>
</div>

<!-- TOC 悬浮按钮. -->

<div id="floating-toc-btn" class="hide-on-med-and-down">
    <a class="btn-floating btn-large bg-color">
        <i class="fas fa-list-ul"></i>
    </a>
</div>


<script src=""></script>
<script>
    $.getScript("/libs/tocbot/tocbot.min.js",function () {
        tocbot.init({
            tocSelector: '#toc-content',
            contentSelector: '#articleContent',
            headingsOffset: -($(window).height() * 0.4 - 45),
            collapseDepth: Number('0'),
            headingSelector: 'h2, h3, h4'
        });

        // modify the toc link href to support Chinese.
        let i = 0;
        let tocHeading = 'toc-heading-';
        $('#toc-content a').each(function () {
            $(this).attr('href', '#' + tocHeading + (++i));
        });

        // modify the heading title id to support Chinese.
        i = 0;
        $('#articleContent').children('h2, h3, h4').each(function () {
            $(this).attr('id', tocHeading + (++i));
        });

        // Set scroll toc fixed.
        let tocHeight = parseInt($(window).height() * 0.4 - 64);
        let $tocWidget = $('.toc-widget');
        $(window).scroll(function () {
            let scroll = $(window).scrollTop();
            /* add post toc fixed. */
            if (scroll > tocHeight) {
                $tocWidget.addClass('toc-fixed');
            } else {
                $tocWidget.removeClass('toc-fixed');
            }
        });

        
        /* 修复文章卡片 div 的宽度. */
        let fixPostCardWidth = function (srcId, targetId) {
            let srcDiv = $('#' + srcId);
            if (srcDiv.length === 0) {
                return;
            }

            let w = srcDiv.width();
            if (w >= 450) {
                w = w + 21;
            } else if (w >= 350 && w < 450) {
                w = w + 18;
            } else if (w >= 300 && w < 350) {
                w = w + 16;
            } else {
                w = w + 14;
            }
            $('#' + targetId).width(w);
        };

        // 切换TOC目录展开收缩的相关操作.
        const expandedClass = 'expanded';
        let $tocAside = $('#toc-aside');
        let $mainContent = $('#main-content');
        $('#floating-toc-btn .btn-floating').click(function () {
            if ($tocAside.hasClass(expandedClass)) {
                $tocAside.removeClass(expandedClass).hide();
                $mainContent.removeClass('l9');
            } else {
                $tocAside.addClass(expandedClass).show();
                $mainContent.addClass('l9');
            }
            fixPostCardWidth('artDetail', 'prenext-posts');
        });
        
    })
</script>

    

</main>



</main>

<footer class="page-footer bg-color">
    
    <div class="container row center-align"
         style="margin-bottom: 0px !important;">
        <div class="col s12 m8 l8 copy-right">
            Copyright&nbsp;&copy;
            
                <span id="year">2019-2024</span>
            
            <a href="/about" target="_blank">chens</a>
            |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a>
            <br>
            
            
            
                
            
            
                <span id="busuanzi_container_site_pv">
                &nbsp;|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;
                    <span id="busuanzi_value_site_pv" class="white-color"></span>
            </span>
            
            
                <span id="busuanzi_container_site_uv">
                &nbsp;|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;
                    <span id="busuanzi_value_site_uv" class="white-color"></span>
            </span>
            
            <br>

            <!-- 运行天数提醒. -->
            
            <br>
            
        </div>
        <div class="col s12 m4 l4 social-link social-statis">
    <a href="https://github.com/ufofly" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50">
        <i class="fab fa-github"></i>
    </a>



    <a href="mailto:517988369@qq.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50">
        <i class="fas fa-envelope-open"></i>
    </a>









</div>
    </div>
</footer>

<div class="progress-bar"></div>


<!-- 搜索遮罩框 -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span>
            <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script type="text/javascript">
$(function () {
    var searchFunc = function (path, search_id, content_id) {
        'use strict';
        $.ajax({
            url: path,
            dataType: "xml",
            success: function (xmlResponse) {
                // get the contents from search data
                var datas = $("entry", xmlResponse).map(function () {
                    return {
                        title: $("title", this).text(),
                        content: $("content", this).text(),
                        url: $("url", this).text()
                    };
                }).get();
                var $input = document.getElementById(search_id);
                var $resultContent = document.getElementById(content_id);
                $input.addEventListener('input', function () {
                    var str = '<ul class=\"search-result-list\">';
                    var keywords = this.value.trim().toLowerCase().split(/[\s\-]+/);
                    $resultContent.innerHTML = "";
                    if (this.value.trim().length <= 0) {
                        return;
                    }
                    // perform local searching
                    datas.forEach(function (data) {
                        var isMatch = true;
                        var data_title = data.title.trim().toLowerCase();
                        var data_content = data.content.trim().replace(/<[^>]+>/g, "").toLowerCase();
                        var data_url = data.url;
                        data_url = data_url.indexOf('/') === 0 ? data.url : '/' + data_url;
                        var index_title = -1;
                        var index_content = -1;
                        var first_occur = -1;
                        // only match artiles with not empty titles and contents
                        if (data_title !== '' && data_content !== '') {
                            keywords.forEach(function (keyword, i) {
                                index_title = data_title.indexOf(keyword);
                                index_content = data_content.indexOf(keyword);
                                if (index_title < 0 && index_content < 0) {
                                    isMatch = false;
                                } else {
                                    if (index_content < 0) {
                                        index_content = 0;
                                    }
                                    if (i === 0) {
                                        first_occur = index_content;
                                    }
                                }
                            });
                        }
                        // show search results
                        if (isMatch) {
                            str += "<li><a href='" + data_url + "' class='search-result-title'>" + data_title + "</a>";
                            var content = data.content.trim().replace(/<[^>]+>/g, "");
                            if (first_occur >= 0) {
                                // cut out 100 characters
                                var start = first_occur - 20;
                                var end = first_occur + 80;
                                if (start < 0) {
                                    start = 0;
                                }
                                if (start === 0) {
                                    end = 100;
                                }
                                if (end > content.length) {
                                    end = content.length;
                                }
                                var match_content = content.substr(start, end);
                                // highlight all keywords
                                keywords.forEach(function (keyword) {
                                    var regS = new RegExp(keyword, "gi");
                                    match_content = match_content.replace(regS, "<em class=\"search-keyword\">" + keyword + "</em>");
                                });

                                str += "<p class=\"search-result\">" + match_content + "...</p>"
                            }
                            str += "</li>";
                        }
                    });
                    str += "</ul>";
                    $resultContent.innerHTML = str;
                });
            }
        });
    };

    searchFunc('/search.xml', 'searchInput', 'searchResult');
});
</script>

<!-- 深色模式按钮 -->
<a onclick="switchNightMode()" id="sma" title="模式切换">
    <i class="fa fa-moon" id="nightMode" aria-hidden="true"></i>
</a>
<!-- 回到顶部按钮 -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fas fa-arrow-up"></i>
    </a>
</div>


<script type="text/javascript">
    $.getScript("https://files.islu.cn/static/pjax/pjax.min.js",loadPjax)
    function loadPjax(){
        var pjax = new Pjax({
            selectors: [
                "head title",
                'head meta[name="keywords"]',
                'head meta[name="description"]',
                "main#main_wrap",
                "#rightside"
            ],
            cache: true,
            cacheBust: false
        });
    }

    // 开始 PJAX 执行的函数
    document.addEventListener('pjax:send', function () {
    });
    // PJAX 完成之后执行的函数，可以和上面的重载放在一起
    document.addEventListener('pjax:complete', function () {
        document.querySelectorAll('script[data-pjax]').forEach(item => {
            const newScript = document.createElement('script')
            const content = item.text || item.textContent || item.innerHTML || ""
            Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
            newScript.appendChild(document.createTextNode(content))
            item.parentNode.replaceChild(newScript, item)
        })
    });

    // Pjax请求错误时，跳转到404页面
    document.addEventListener('pjax:error', (err) => {
        if (err.request.status === 404) {
            pjax.loadUrl('/404.html')
        }
    })
</script>


<script src="/libs/materialize/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>





<!-- 雪花特效 -->


<!-- 鼠标星星特效 -->



    <script src="https://ssl.captcha.qq.com/TCaptcha.js"></script>
    <script src="/libs/others/TencentCaptcha.js"></script>
    <button id="TencentCaptcha" data-appid="xxxxxxxxxx" data-cbfn="callback" type="button"
            hidden></button>


<!-- Baidu Analytics -->

<!-- Baidu Push -->

<script>
    (function () {
        var bp = document.createElement('script');
        var curProtocol = window.location.protocol.split(':')[0];
        if (curProtocol === 'https') {
            bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
        } else {
            bp.src = 'http://push.zhanzhang.baidu.com/push.js';
        }
        var s = document.getElementsByTagName("script")[0];
        s.parentNode.insertBefore(bp, s);
    })();
</script>


    <script src="/libs/others/clicklove.js" async="async"></script>


    <script async src="/libs/others/busuanzi.pure.mini.js"></script>






<!--腾讯兔小巢-->








    <script src="/libs/instantpage/instantpage.js" type="module"></script>


</body>

</html>
